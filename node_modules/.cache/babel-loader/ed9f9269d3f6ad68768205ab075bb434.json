{"ast":null,"code":"import _regeneratorRuntime from\"/Users/macbook/Desktop/a.micole_rebe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/macbook/Desktop/a.micole_rebe/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from\"react\";// reactstrap components\nimport{Badge,Button,Card,CardHeader,CardBody,CardFooter,CardTitle,CardText,Label,FormGroup,Input,Alert,Table,Row,Col,UncontrolledTooltip,Form}from\"reactstrap\";import ReactBSAlert from\"react-bootstrap-sweetalert\";import ReactDatetime from\"react-datetime\";import defaultImage from\"assets/img/image_placeholder.jpg\";import defaultAvatar from\"assets/img/placeholder.jpg\";import Select from\"react-select\";import*as mainActions from\"../actions/mainActions\";import{connect}from'react-redux';class Mensajes extends React.Component{constructor(){var _this;super();_this=this;this.handleRefresh=()=>{// by calling this method react re-renders the component\nthis.verMensaje(this.props.colegio.codigo);console.log(\"Pagina Refrescada\");};this.setGrado=value=>{this.setState({singleSelect:value});if(value.value>6){this.setState({materias:this.props.Secundaria});}else{this.setState({materias:this.props.Primaria});}};this.setSeccion=value=>{this.setState({seccion:value});console.log(value);};this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_this.props.verCredenciales();if(!_this.props.colegio.id){_this.props.history.push(\"/auth/login\");}_context.next=4;return _this.verMensaje(_this.props.colegio.codigo);case 4:case\"end\":return _context.stop();}},_callee);}));this.verMensaje=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(codigo){var url,respuesta,mensajes;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:url='https://webhooks.mongodb-realm.com/api/client/v2.0/app/aprendemicolegio-kmnsj/service/micolegio/incoming_webhook/leerMensajes?codigo='+codigo;_context2.next=3;return fetch(url,{method:'GET',mode:'cors',cache:'default',headers:{'Content-Type':'application/json'},Accept:'application/json'}).catch(error=>{console.log(error);});case 3:respuesta=_context2.sent;_context2.next=6;return respuesta.json();case 6:mensajes=_context2.sent;_this.setState({mensajes:mensajes});case 8:case\"end\":return _context2.stop();}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();this.enviarMensaje=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var negado,data,url,respuesta,result;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(!(_this.state.singleSelect==null)){_context3.next=5;break;}negado=/*#__PURE__*/React.createElement(Alert,{color:\"info\"},/*#__PURE__*/React.createElement(\"span\",null,\"Se require Grado\"));_this.setState({subiendo:negado});_context3.next=17;break;case 5:data={plantel:_this.props.colegio.codigo,grado:_this.state.singleSelect,seccion:_this.state.seccion.value,fecha:_this.state.fecha,mensaje:_this.state.mensaje};url='https://webhooks.mongodb-realm.com/api/client/v2.0/app/aprendemicolegio-kmnsj/service/masterside/incoming_webhook/registrarMensaje';_context3.next=9;return fetch(url,{method:'POST',body:JSON.stringify(data),headers:{'Content-Type':'application/json'},Accept:'application/json'}).catch(error=>{console.log(error);});case 9:respuesta=_context3.sent;_this.setState({// seccion:null,\nsingleSelect:null,mensaje:null,fecha:null});_context3.next=13;return _this.verMensaje(_this.props.colegio.codigo);case 13:_context3.next=15;return respuesta.json(data);case 15:result=_context3.sent;console.log(result);case 17:case\"end\":return _context3.stop();}},_callee3);}));this.quitarMensaje=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(id){var datadir,url;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:datadir={codigo:id};console.log(datadir);url='https://webhooks.mongodb-realm.com/api/client/v2.0/app/aprendemicolegio-kmnsj/service/masterside/incoming_webhook/quitarRecurso';fetch(url,{method:'POST',body:JSON.stringify(datadir),headers:{'Content-Type':'application/json'},Accept:'application/json'}).then(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(resp){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _this.verMensaje(_this.props.colegio.id);case 2:case\"end\":return _context4.stop();}},_callee4);}));return function(_x3){return _ref5.apply(this,arguments);};}()).catch(error=>{console.log(error);});case 4:case\"end\":return _context5.stop();}},_callee5);}));return function(_x2){return _ref4.apply(this,arguments);};}();this.state={singleSelect:null,subiendo:null,seccion:\"*\",titulo:null,fecha:null,Grado:[],Seccion:[],Primaria:[],Secundaria:[],modulos:[],itemscurriculo:[],curriculo:null,acepta:\"*\",parabuscar:null,subirRecurso:null,mensaje:null,mensajes:[]};this.handleSubmit=this.handleSubmit.bind(this);this.handleClick=this.handleClick.bind(this);this.handleRemove=this.handleRemove.bind(this);}handleSubmit(e){e.preventDefault();}handleClick(e){this.refs.fileInput.click();}handleRemove(){this.setState({file:null,imagePreviewUrl:this.props.avatar?defaultAvatar:defaultImage});this.refs.fileInput.value=null;}render(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"content\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:\"6\",lg:\"6\"},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardHeader,null,/*#__PURE__*/React.createElement(CardTitle,{tag:\"h4\"},\"Registro de Mensajes\")),/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(Form,{className:\"form-horizontal\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Label,{md:\"3\"},\"Grado o a\\xF1o\"),/*#__PURE__*/React.createElement(Col,{md:\"6\"},/*#__PURE__*/React.createElement(Select,{className:\"react-select primary\",classNamePrefix:\"react-select\",name:\"singleSelect\",value:this.state.singleSelect,onChange:value=>this.setGrado(value),options:this.props.Grado,placeholder:\"Seleccion el Grado o a\\xF1o\"})),/*#__PURE__*/React.createElement(Col,{md:\"3\"},/*#__PURE__*/React.createElement(Select,{className:\"react-select primary\",classNamePrefix:\"react-select\",name:\"seccion\",value:this.state.seccion.value,onChange:value=>this.setSeccion(value),options:this.props.Seccion,placeholder:\"Seccion\"}))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Label,{md:\"3\"},\"Contenido del Mensaje\"),/*#__PURE__*/React.createElement(Col,{md:\"9\"},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Input,{placeholder:\"Asunto del mensaje\",type:\"text\",value:this.state.mensaje,onChange:texto=>this.setState({mensaje:texto.target.value})})))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Label,{md:\"3\"},\"Fecha de envio\"),/*#__PURE__*/React.createElement(Col,{md:\"6\"},/*#__PURE__*/React.createElement(ReactDatetime,{inputProps:{className:\"form-control\",placeholder:\"Date Picker Here\"},timeFormat:false,value:this.state.fecha,onChange:value=>this.setState({fecha:value})}))))),/*#__PURE__*/React.createElement(CardFooter,null,this.state.mensaje?/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:\"3\"}),/*#__PURE__*/React.createElement(Col,{md:\"9\"},/*#__PURE__*/React.createElement(Button,{className:\"btn-round\",color:\"info\",type:\"button\",onClick:()=>this.enviarMensaje()},\"Registrar mensaje\"))):null)))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{className:\"text-center\",lg:\"12\",md:\"12\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{className:\"text-center\",lg:\"12\",md:\"12\"},/*#__PURE__*/React.createElement(Card,{className:\"card-tasks\"},/*#__PURE__*/React.createElement(CardHeader,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:\"6\"},/*#__PURE__*/React.createElement(CardTitle,{tag:\"h3\"},/*#__PURE__*/React.createElement(Button,{className:\"btn-round btn-icon\",className:\"btn-link\",color:\"info\",onClick:this.handleRefresh},/*#__PURE__*/React.createElement(\"i\",{className:\"nc-icon nc-refresh-69\"})),\"Mensajes Activos\")))),/*#__PURE__*/React.createElement(CardBody,{className:\"table-full-width table-hover\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:\"12\"},/*#__PURE__*/React.createElement(Table,{responsive:true},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null),/*#__PURE__*/React.createElement(\"th\",null,\"Grado\"),/*#__PURE__*/React.createElement(\"th\",null,\"Seccion\"),/*#__PURE__*/React.createElement(\"th\",null,\"Asunto\"),/*#__PURE__*/React.createElement(\"th\",null,\"Fecha\"),/*#__PURE__*/React.createElement(\"th\",null,\"Accion\"))),/*#__PURE__*/React.createElement(\"tbody\",null,this.state.mensajes.map(mensaje=>/*#__PURE__*/React.createElement(\"tr\",{className:\"table\"},/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"timeline-badge danger\"},/*#__PURE__*/React.createElement(\"i\",{className:\"nc-icon nc-single-copy-04\"}))),/*#__PURE__*/React.createElement(\"td\",{className:\"text-left\"},mensaje.grado.label),/*#__PURE__*/React.createElement(\"td\",{className:\"text-left\"},mensaje.seccion),/*#__PURE__*/React.createElement(\"td\",{className:\"text-left\"},mensaje.mensaje),/*#__PURE__*/React.createElement(\"td\",{className:\"text-left\"},mensaje.fecha,\" (\",mensaje.hora,\")\"),/*#__PURE__*/React.createElement(\"td\",{className:\"td-actions text-right\"},/*#__PURE__*/React.createElement(Button,{className:\"btn-round btn-icon\",color:\"danger\",type:\"button\",onClick:()=>this.quitarMensaje(mensaje._id)},/*#__PURE__*/React.createElement(\"i\",{className:\"nc-icon nc-simple-remove\"})))))))))))))))));}}const mapStateToProps=reducers=>{return reducers.mainReducer;};export default connect(mapStateToProps,mainActions)(Mensajes);","map":{"version":3,"sources":["/Users/macbook/Desktop/a.micole_rebe/client/src/views/Mensajes.js"],"names":["React","Badge","Button","Card","CardHeader","CardBody","CardFooter","CardTitle","CardText","Label","FormGroup","Input","Alert","Table","Row","Col","UncontrolledTooltip","Form","ReactBSAlert","ReactDatetime","defaultImage","defaultAvatar","Select","mainActions","connect","Mensajes","Component","constructor","handleRefresh","verMensaje","props","colegio","codigo","console","log","setGrado","value","setState","singleSelect","materias","Secundaria","Primaria","setSeccion","seccion","componentDidMount","verCredenciales","id","history","push","url","fetch","method","mode","cache","headers","Accept","catch","error","respuesta","json","mensajes","enviarMensaje","state","negado","subiendo","data","plantel","grado","fecha","mensaje","body","JSON","stringify","result","quitarMensaje","datadir","then","resp","titulo","Grado","Seccion","modulos","itemscurriculo","curriculo","acepta","parabuscar","subirRecurso","handleSubmit","bind","handleClick","handleRemove","e","preventDefault","refs","fileInput","click","file","imagePreviewUrl","avatar","render","texto","target","className","placeholder","map","label","hora","_id","mapStateToProps","reducers","mainReducer"],"mappings":"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","sourcesContent":["\nimport React from \"react\";\n\n// reactstrap components\nimport {\n  Badge,\n  Button,\n  Card,\n  CardHeader,\n  CardBody,\n  CardFooter,\n  CardTitle,\n  CardText,\n  Label,\n  FormGroup,\n  Input,\n  Alert,\n  Table,\n  Row,\n  Col,\n  UncontrolledTooltip,\n  Form,\n} from \"reactstrap\";\nimport ReactBSAlert from \"react-bootstrap-sweetalert\";\nimport ReactDatetime from \"react-datetime\";\nimport defaultImage from \"assets/img/image_placeholder.jpg\";\nimport defaultAvatar from \"assets/img/placeholder.jpg\";\nimport Select from \"react-select\";\nimport * as mainActions from \"../actions/mainActions\";\nimport { connect } from 'react-redux';\n\nclass Mensajes extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      singleSelect: null,\n      subiendo: null,\n      seccion:\"*\",\n      titulo:null,\n      fecha:null,\n      Grado:[],\n      Seccion:[],\n      Primaria:[],\n      Secundaria:[],\n      modulos:[],\n      itemscurriculo:[],\n      curriculo:null,\n      acepta:\"*\",\n      parabuscar:null,\n      subirRecurso:null,\n      mensaje:null,\n      mensajes:[],\n    };\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n    this.handleRemove = this.handleRemove.bind(this);\n  };\n\n  handleSubmit(e) {\n    e.preventDefault();\n  };\n\n  handleClick(e) {\n    this.refs.fileInput.click();\n  };\n\n  handleRemove() {\n    this.setState({\n      file: null,\n      imagePreviewUrl: this.props.avatar ? defaultAvatar : defaultImage,\n    });\n    this.refs.fileInput.value = null;\n  };\n\n  handleRefresh = () => {\n    // by calling this method react re-renders the component\n    this.verMensaje(this.props.colegio.codigo);\n    console.log(\"Pagina Refrescada\")\n  };\n\n  setGrado = (value) => {\n    this.setState({ singleSelect: value })\n    if(value.value>6){\n      this.setState({materias:this.props.Secundaria})\n    }else{\n      this.setState({materias:this.props.Primaria})\n    }\n  };\n\n  setSeccion = (value) => {\n    this.setState({ seccion: value })\n    console.log(value)\n  };\n\n  componentDidMount = async () => {\n    this.props.verCredenciales();\n    if(!this.props.colegio.id){\n      this.props.history.push(\"/auth/login\");\n    }\n    await this.verMensaje(this.props.colegio.codigo);\n  };\n\n  verMensaje = async (codigo) => {\n    let url='https://webhooks.mongodb-realm.com/api/client/v2.0/app/aprendemicolegio-kmnsj/service/micolegio/incoming_webhook/leerMensajes?codigo='+codigo;\n    let respuesta = await fetch(url, {\n        method: 'GET',\n        mode: 'cors',\n        cache: 'default',\n        headers:{\n            'Content-Type': 'application/json'\n        },\n        Accept: 'application/json',\n    }).catch(error => {\n        console.log(error);\n    });\n    let mensajes = await respuesta.json();\n    this.setState({ mensajes:mensajes });\n  };\n\n  enviarMensaje = async () =>{\n    if (this.state.singleSelect == null) {\n      let negado = (\n        <Alert color=\"info\">\n          <span>Se require Grado</span>\n        </Alert>\n      )\n      this.setState({subiendo:negado});\n    } else {\n      const data = {\n      plantel:this.props.colegio.codigo,\n      grado: this.state.singleSelect,\n      seccion:this.state.seccion.value,\n      fecha: this.state.fecha,\n      mensaje:this.state.mensaje,\n    };\n    let url='https://webhooks.mongodb-realm.com/api/client/v2.0/app/aprendemicolegio-kmnsj/service/masterside/incoming_webhook/registrarMensaje';\n    let respuesta = await fetch(url, {\n      method: 'POST',\n      body: JSON.stringify(data),\n      headers:{\n        'Content-Type': 'application/json'\n      },\n      Accept: 'application/json',\n    })\n    .catch(error => {\n        console.log(error);\n    });\n    this.setState({\n      // seccion:null,\n      singleSelect:null,\n      mensaje:null,\n      fecha:null\n    });\n    await this.verMensaje(this.props.colegio.codigo);\n    let result = await respuesta.json(data);\n    console.log(result)\n    }\n  };\n\n  quitarMensaje = async (id) => {\n    const datadir = {\n      codigo:id,\n    };\n    console.log(datadir)\n    let url='https://webhooks.mongodb-realm.com/api/client/v2.0/app/aprendemicolegio-kmnsj/service/masterside/incoming_webhook/quitarRecurso';\n    fetch(url, {\n        method: 'POST',\n        body: JSON.stringify(datadir),\n        headers:{\n            'Content-Type': 'application/json'\n        },\n        Accept: 'application/json',\n    })\n    .then(async resp  => {\n        await this.verMensaje(this.props.colegio.id);\n    })\n    .catch(error => {\n        console.log(error);\n    });\n  };\n\n  render() {\n    return (\n      <>\n        <div className=\"content\">\n          <Row>\n            <Col md=\"6\" lg=\"6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle tag=\"h4\">Registro de Mensajes</CardTitle>\n                </CardHeader>\n                <CardBody>\n                  <Form className=\"form-horizontal\" >\n                    <Row>\n                      <Label md=\"3\">Grado o año</Label>\n                      <Col md=\"6\">\n                        <Select\n                          className=\"react-select primary\"\n                          classNamePrefix=\"react-select\"\n                          name=\"singleSelect\"\n                          value={this.state.singleSelect}\n                          onChange={(value) =>\n                            this.setGrado(value)\n                          }\n                          options={this.props.Grado}\n                          placeholder=\"Seleccion el Grado o año\"\n                        />\n                      </Col>\n                      <Col md=\"3\">\n                        <Select\n                          className=\"react-select primary\"\n                          classNamePrefix=\"react-select\"\n                          name=\"seccion\"\n                          value={this.state.seccion.value}\n                          onChange={(value) =>\n                            this.setSeccion(value)\n                          }\n                          options={this.props.Seccion}\n                          placeholder=\"Seccion\"\n                        />\n                      </Col>\n                    </Row>\n                    <Row>\n                      <Label md=\"3\">Contenido del Mensaje</Label>\n                      <Col md=\"9\">\n                        <FormGroup>\n                          <Input placeholder=\"Asunto del mensaje\"\n                            type=\"text\"\n                            value={this.state.mensaje}\n                            onChange={(texto) =>\n                              this.setState({ mensaje:texto.target.value })\n                            }\n                          />\n                        </FormGroup>\n                      </Col>\n                    </Row>\n                    <Row>\n                      <Label md=\"3\">Fecha de envio</Label>\n                      <Col md=\"6\">\n                        <ReactDatetime\n                          inputProps={{\n                            className: \"form-control\",\n                            placeholder: \"Date Picker Here\",\n                          }}\n                          timeFormat={false}\n                          value={this.state.fecha}\n                          onChange={(value) =>\n                            this.setState({ fecha: value })\n                          }\n                        />\n                      </Col>\n                    </Row>\n                  </Form>\n                </CardBody>\n                <CardFooter>\n                  {this.state.mensaje ? (\n                    <Row>\n                      <Col md=\"3\" />\n                      <Col md=\"9\">\n                        <Button className=\"btn-round\"\n                        color=\"info\" type=\"button\"\n                        onClick={()=>this.enviarMensaje()}\n                      >\n                          Registrar mensaje\n                        </Button>\n                      </Col>\n                    </Row>\n                    ):(null)}\n                  </CardFooter>\n              </Card>\n            </Col>\n          </Row>\n          <Row>\n            <Col className=\"text-center\" lg=\"12\" md=\"12\">\n              <Row>\n                <Col className=\"text-center\" lg=\"12\" md=\"12\">\n                  <Card className=\"card-tasks\">\n                    <CardHeader>\n                      <Row>\n                        <Col md=\"6\">\n                          <CardTitle tag=\"h3\">\n                            <Button\n                              className=\"btn-round btn-icon\"\n                              className=\"btn-link\"\n                              color=\"info\"\n                              onClick={this.handleRefresh}\n                            >\n                              <i className=\"nc-icon nc-refresh-69\" />\n                            </Button>\n                            Mensajes Activos\n                          </CardTitle>\n                        </Col>\n                        {/* <Col md=\"6\">\n                          <Select\n                            className=\"react-select primary\"\n                            classNamePrefix=\"react-select\"\n                            name=\"parabuscar\"\n                            value={this.state.parabuscar}\n                            onChange={(value) => {\n                              this.verMensaje(this.props.colegio.id,value,null);\n                              this.setState({parabuscar: value });\n                            }}\n                            options={this.props.Grado}\n                            placeholder=\"Seleccione Grado o Año\"\n                          />\n                        </Col> */}\n                      </Row>\n                    </CardHeader>\n                    <CardBody className=\"table-full-width table-hover\">\n                      <Row>\n                        <Col md=\"12\">\n                          <Table responsive>\n                          <thead>\n                            <tr>\n                              <th></th>\n                              <th>Grado</th>\n                              <th>Seccion</th>\n                              <th>Asunto</th>\n                              <th>Fecha</th>\n                              <th>Accion</th>\n                            </tr>\n                          </thead>\n                          <tbody>\n                            {this.state.mensajes.map(mensaje=>(\n                              <tr className=\"table\">\n                                <td>\n                                  <div className=\"timeline-badge danger\">\n                                    <i className=\"nc-icon nc-single-copy-04\" />\n                                  </div>\n                                </td>\n                                <td className=\"text-left\">\n                                  {mensaje.grado.label}\n                                </td><td className=\"text-left\">\n                                  {mensaje.seccion}\n                                </td>\n                                <td className=\"text-left\">\n                                  {mensaje.mensaje}\n                                </td>\n                                <td className=\"text-left\">\n                                  {mensaje.fecha} ({mensaje.hora})\n                                </td>\n                                <td className=\"td-actions text-right\">\n                                  <Button\n                                    className=\"btn-round btn-icon\"\n                                    color=\"danger\"\n                                    type=\"button\"\n                                    onClick={()=>this.quitarMensaje(mensaje._id)}\n                                  >\n                                    <i className=\"nc-icon nc-simple-remove\" />\n                                  </Button>\n                                </td>\n                              </tr>\n                            ))}\n                          </tbody>\n                          </Table>\n                        </Col>\n                      </Row>\n                    </CardBody>\n                  </Card>\n                </Col>\n              </Row>\n            </Col>\n          </Row>\n        </div>\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = (reducers) => {\n  return reducers.mainReducer;\n}\n\nexport default connect(mapStateToProps, mainActions )(Mensajes);\n"]},"metadata":{},"sourceType":"module"}