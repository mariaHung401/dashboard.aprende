{"ast":null,"code":"import _regeneratorRuntime from\"/Users/macbook/Desktop/a.micole_rebe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/macbook/Desktop/a.micole_rebe/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from\"react\";// reactstrap components\nimport{Badge,Button,Card,CardHeader,CardBody,CardFooter,CardTitle,CardText,Label,FormGroup,Input,Alert,Table,Row,Col,UncontrolledTooltip,Form}from\"reactstrap\";import ReactBSAlert from\"react-bootstrap-sweetalert\";import ReactDatetime from\"react-datetime\";import defaultImage from\"assets/img/image_placeholder.jpg\";import defaultAvatar from\"assets/img/placeholder.jpg\";import Select from\"react-select\";import*as mainActions from\"../actions/mainActions\";import{connect}from'react-redux';class Mensajes extends React.Component{constructor(){var _this;super();_this=this;this.setGrado=value=>{this.setState({singleSelect:value});if(value.value>6){this.setState({materias:this.props.Secundaria});}else{this.setState({materias:this.props.Primaria});}};this.setSeccion=value=>{this.setState({seccion:value});console.log(value);};this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_this.props.verCredenciales();if(!_this.props.colegio.id){_this.props.history.push(\"/auth/login\");}_context.next=4;return _this.verMensaje(_this.props.colegio.codigo,\"*\");case 4:case\"end\":return _context.stop();}},_callee);}));this.verMensaje=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(codigo){var url,respuesta,mensajes;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:url='https://webhooks.mongodb-realm.com/api/client/v2.0/app/aprendemicolegio-kmnsj/service/micolegio/incoming_webhook/leerMensajes?codigo='+codigo;_context2.next=3;return fetch(url,{method:'GET',mode:'cors',cache:'default',headers:{'Content-Type':'application/json'},Accept:'application/json'}).catch(error=>{console.log(error);});case 3:respuesta=_context2.sent;_context2.next=6;return respuesta.json();case 6:mensajes=_context2.sent;_this.setState({mensajes:mensajes});console.log(mensajes);console.log(codigo);case 10:case\"end\":return _context2.stop();}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();this.enviarMensaje=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var negado,data,url,respuesta,result;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:if(!(_this.state.singleSelect==null)){_context3.next=5;break;}negado=/*#__PURE__*/React.createElement(Alert,{color:\"info\"},/*#__PURE__*/React.createElement(\"span\",null,\"Se require Grado\"));_this.setState({subiendo:negado});_context3.next=17;break;case 5:data={plantel:_this.props.colegio.codigo,grado:_this.state.singleSelect,seccion:_this.state.seccion.value,fecha:_this.state.fecha,mensaje:_this.state.mensaje};url='https://webhooks.mongodb-realm.com/api/client/v2.0/app/aprendemicolegio-kmnsj/service/masterside/incoming_webhook/registrarMensaje';_context3.next=9;return fetch(url,{method:'POST',body:JSON.stringify(data),headers:{'Content-Type':'application/json'},Accept:'application/json'}).catch(error=>{console.log(error);});case 9:respuesta=_context3.sent;_this.setState({// seccion:null,\nsingleSelect:null});_context3.next=13;return _this.verMensaje(_this.props.colegio.codigo);case 13:_context3.next=15;return respuesta.json(data);case 15:result=_context3.sent;console.log(result);case 17:case\"end\":return _context3.stop();}},_callee3);}));this.state={singleSelect:null,subiendo:null,seccion:\"*\",titulo:null,fecha:null,Grado:[],Seccion:[],Primaria:[],Secundaria:[],modulos:[],itemscurriculo:[],curriculo:null,acepta:\"*\",parabuscar:null,subirRecurso:null,mensaje:null,mensajes:[]};this.handleSubmit=this.handleSubmit.bind(this);this.handleClick=this.handleClick.bind(this);this.handleRemove=this.handleRemove.bind(this);}handleSubmit(e){e.preventDefault();}handleClick(e){this.refs.fileInput.click();}handleRemove(){this.setState({file:null,imagePreviewUrl:this.props.avatar?defaultAvatar:defaultImage});this.refs.fileInput.value=null;}render(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"content\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:\"6\",lg:\"6\"},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardHeader,null,/*#__PURE__*/React.createElement(CardTitle,{tag:\"h4\"},\"Registro de Mensajes\")),/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(Form,{className:\"form-horizontal\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Label,{md:\"3\"},\"Grado o a\\xF1o\"),/*#__PURE__*/React.createElement(Col,{md:\"6\"},/*#__PURE__*/React.createElement(Select,{className:\"react-select primary\",classNamePrefix:\"react-select\",name:\"singleSelect\",value:this.state.singleSelect,onChange:value=>this.setGrado(value),options:this.props.Grado,placeholder:\"Seleccion el Grado o a\\xF1o\"})),/*#__PURE__*/React.createElement(Col,{md:\"3\"},/*#__PURE__*/React.createElement(Select,{className:\"react-select primary\",classNamePrefix:\"react-select\",name:\"seccion\",value:this.state.seccion.value,onChange:value=>this.setSeccion(value),options:this.props.Seccion,placeholder:\"Seccion\"}))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Label,{md:\"3\"},\"Contenido del Mensaje\"),/*#__PURE__*/React.createElement(Col,{md:\"9\"},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Input,{placeholder:\"Asunto del mensaje\",type:\"text\",value:this.state.mensaje,onChange:texto=>this.setState({mensaje:texto.target.value})})))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Label,{md:\"3\"},\"Fecha de envio\"),/*#__PURE__*/React.createElement(Col,{md:\"6\"},/*#__PURE__*/React.createElement(ReactDatetime,{inputProps:{className:\"form-control\",placeholder:\"Date Picker Here\"},timeFormat:false,value:this.state.fecha,onChange:value=>this.setState({fecha:value})}))))),/*#__PURE__*/React.createElement(CardFooter,null,this.state.mensaje?/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:\"3\"}),/*#__PURE__*/React.createElement(Col,{md:\"9\"},/*#__PURE__*/React.createElement(Button,{className:\"btn-round\",color:\"info\",type:\"button\",onClick:()=>this.enviarMensaje()},\"Registrar mensaje\"))):null))),/*#__PURE__*/React.createElement(Col,{md:\"6\",lg:\"6\"},/*#__PURE__*/React.createElement(Card,{className:\"card-tasks\"},/*#__PURE__*/React.createElement(CardHeader,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{md:\"12\"},/*#__PURE__*/React.createElement(CardTitle,{tag:\"h4\"},\"Mensajes Enviados\")),/*#__PURE__*/React.createElement(Col,{md:\"6\"},/*#__PURE__*/React.createElement(Select,{className:\"react-select primary\",classNamePrefix:\"react-select\",name:\"singleSelect\",value:this.state.parabuscar,onChange:value=>this.verMensaje(this.props.colegio.codigo,value.key),options:this.props.Grado,placeholder:\"Seleccion el Grado o a\\xF1o\"})))),/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(\"div\",{className:\"table-full-width table-responsive\"},/*#__PURE__*/React.createElement(Table,null,/*#__PURE__*/React.createElement(\"tbody\",null,this.state.mensajes.map(mensaje=>/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"timeline-badge danger\"},/*#__PURE__*/React.createElement(\"i\",{className:\"nc-icon nc-single-copy-04\"}))),/*#__PURE__*/React.createElement(\"td\",{className:\"text-left\"},mensaje.grado.label,\" \",mensaje.seccion),/*#__PURE__*/React.createElement(\"td\",{className:\"text-left\"},mensaje.mensaje),/*#__PURE__*/React.createElement(\"td\",{className:\"text-left\"},mensaje.fecha,\" (\",mensaje.hora,\")\"))))))),/*#__PURE__*/React.createElement(CardFooter,null,/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"stats\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-refresh spin\"}),\"Updated 3 minutes ago\")))))));}}const mapStateToProps=reducers=>{return reducers.mainReducer;};export default connect(mapStateToProps,mainActions)(Mensajes);","map":{"version":3,"sources":["/Users/macbook/Desktop/a.micole_rebe/src/views/Mensajes.js"],"names":["React","Badge","Button","Card","CardHeader","CardBody","CardFooter","CardTitle","CardText","Label","FormGroup","Input","Alert","Table","Row","Col","UncontrolledTooltip","Form","ReactBSAlert","ReactDatetime","defaultImage","defaultAvatar","Select","mainActions","connect","Mensajes","Component","constructor","setGrado","value","setState","singleSelect","materias","props","Secundaria","Primaria","setSeccion","seccion","console","log","componentDidMount","verCredenciales","colegio","id","history","push","verMensaje","codigo","url","fetch","method","mode","cache","headers","Accept","catch","error","respuesta","json","mensajes","enviarMensaje","state","negado","subiendo","data","plantel","grado","fecha","mensaje","body","JSON","stringify","result","titulo","Grado","Seccion","modulos","itemscurriculo","curriculo","acepta","parabuscar","subirRecurso","handleSubmit","bind","handleClick","handleRemove","e","preventDefault","refs","fileInput","click","file","imagePreviewUrl","avatar","render","texto","target","className","placeholder","key","map","label","hora","mapStateToProps","reducers","mainReducer"],"mappings":"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","sourcesContent":["\nimport React from \"react\";\n\n// reactstrap components\nimport {\n  Badge,\n  Button,\n  Card,\n  CardHeader,\n  CardBody,\n  CardFooter,\n  CardTitle,\n  CardText,\n  Label,\n  FormGroup,\n  Input,\n  Alert,\n  Table,\n  Row,\n  Col,\n  UncontrolledTooltip,\n  Form,\n} from \"reactstrap\";\nimport ReactBSAlert from \"react-bootstrap-sweetalert\";\nimport ReactDatetime from \"react-datetime\";\nimport defaultImage from \"assets/img/image_placeholder.jpg\";\nimport defaultAvatar from \"assets/img/placeholder.jpg\";\nimport Select from \"react-select\";\nimport * as mainActions from \"../actions/mainActions\";\nimport { connect } from 'react-redux';\nclass Mensajes extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      singleSelect: null,\n      subiendo: null,\n      seccion:\"*\",\n      titulo:null,\n      fecha:null,\n      Grado:[],\n      Seccion:[],\n      Primaria:[],\n      Secundaria:[],\n      modulos:[],\n      itemscurriculo:[],\n      curriculo:null,\n      acepta:\"*\",\n      parabuscar:null,\n      subirRecurso:null,\n      mensaje:null,\n      mensajes:[],\n    };\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleClick = this.handleClick.bind(this);\n    this.handleRemove = this.handleRemove.bind(this);\n  }\n\n  handleSubmit(e) {\n    e.preventDefault();\n  }\n  handleClick(e) {\n    this.refs.fileInput.click();\n  }\n  handleRemove() {\n    this.setState({\n      file: null,\n      imagePreviewUrl: this.props.avatar ? defaultAvatar : defaultImage,\n    });\n    this.refs.fileInput.value = null;\n  }\n  setGrado = (value) => {\n    this.setState({ singleSelect: value })\n    if(value.value>6){\n      this.setState({materias:this.props.Secundaria})\n    }else{\n      this.setState({materias:this.props.Primaria})\n    }\n  }\n  setSeccion = (value) => {\n    this.setState({ seccion: value })\n    console.log(value)\n  }\n\n  componentDidMount = async () => {\n    this.props.verCredenciales();\n    if(!this.props.colegio.id){\n      this.props.history.push(\"/auth/login\");\n    }\n    await this.verMensaje(this.props.colegio.codigo,\"*\");\n  }\n\n  verMensaje = async (codigo) => {\n    let url='https://webhooks.mongodb-realm.com/api/client/v2.0/app/aprendemicolegio-kmnsj/service/micolegio/incoming_webhook/leerMensajes?codigo='+codigo;\n    let respuesta = await fetch(url, {\n        method: 'GET',\n        mode: 'cors',\n        cache: 'default',\n        headers:{\n            'Content-Type': 'application/json'\n        },\n        Accept: 'application/json',\n    }).catch(error => {\n        console.log(error);\n    });\n    let mensajes = await respuesta.json();\n    this.setState({ mensajes:mensajes});\n    console.log(mensajes)\n    console.log(codigo)\n  }\n\n  enviarMensaje = async () =>{\n    // let grado = this.state.singleSelect;\n    if (this.state.singleSelect == null) {\n      let negado = (\n        <Alert color=\"info\">\n          <span>Se require Grado</span>\n        </Alert>\n      )\n      this.setState({subiendo:negado});\n    } else {\n      const data = {\n      plantel:this.props.colegio.codigo,\n      grado: this.state.singleSelect,\n      seccion:this.state.seccion.value,\n      fecha: this.state.fecha,\n      mensaje:this.state.mensaje,\n    };\n    let url='https://webhooks.mongodb-realm.com/api/client/v2.0/app/aprendemicolegio-kmnsj/service/masterside/incoming_webhook/registrarMensaje';\n    let respuesta = await fetch(url, {\n      method: 'POST',\n      body: JSON.stringify(data),\n      headers:{\n        'Content-Type': 'application/json'\n      },\n      Accept: 'application/json',\n    })\n    .catch(error => {\n        console.log(error);\n    });\n    this.setState({\n      // seccion:null,\n      singleSelect:null,\n    });\n    await this.verMensaje(this.props.colegio.codigo);\n    let result = await respuesta.json(data);\n    console.log(result)\n    }\n  }\n\n  render() {\n    return (\n      <>\n        <div className=\"content\">\n          <Row>\n            <Col md=\"6\" lg=\"6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle tag=\"h4\">Registro de Mensajes</CardTitle>\n                </CardHeader>\n                <CardBody>\n                  <Form className=\"form-horizontal\" >\n                    <Row>\n                      <Label md=\"3\">Grado o año</Label>\n                      <Col md=\"6\">\n                        <Select\n                          className=\"react-select primary\"\n                          classNamePrefix=\"react-select\"\n                          name=\"singleSelect\"\n                          value={this.state.singleSelect}\n                          onChange={(value) =>\n                            this.setGrado(value )\n                          }\n                          options={this.props.Grado}\n                          placeholder=\"Seleccion el Grado o año\"\n                        />\n                      </Col>\n                      <Col md=\"3\">\n                        <Select\n                          className=\"react-select primary\"\n                          classNamePrefix=\"react-select\"\n                          name=\"seccion\"\n                          value={this.state.seccion.value}\n                          onChange={(value) =>\n                            this.setSeccion(value)\n                          }\n                          options={this.props.Seccion}\n                          placeholder=\"Seccion\"\n                        />\n                      </Col>\n                    </Row>\n                    <Row>\n                      <Label md=\"3\">Contenido del Mensaje</Label>\n                      <Col md=\"9\">\n                        <FormGroup>\n                          <Input placeholder=\"Asunto del mensaje\"\n                            type=\"text\"\n                            value={this.state.mensaje}\n                            onChange={(texto) =>\n                              this.setState({ mensaje:texto.target.value })\n                            }\n                          />\n                        </FormGroup>\n                      </Col>\n                    </Row>\n                    <Row>\n                      <Label md=\"3\">Fecha de envio</Label>\n                      <Col md=\"6\">\n                        <ReactDatetime\n                          inputProps={{\n                            className: \"form-control\",\n                            placeholder: \"Date Picker Here\",\n                          }}\n                          timeFormat={false}\n                          value={this.state.fecha}\n                          onChange={(value) =>\n                            this.setState({ fecha: value })\n                          }\n                        />\n                      </Col>\n                    </Row>\n                  </Form>\n                </CardBody>\n                <CardFooter>\n                  {this.state.mensaje ? (\n                    <Row>\n                      <Col md=\"3\" />\n                      <Col md=\"9\">\n                        <Button className=\"btn-round\"\n                        color=\"info\" type=\"button\"\n                        onClick={()=>this.enviarMensaje()}\n                      >\n                          Registrar mensaje\n                        </Button>\n                      </Col>\n                    </Row>\n                    ):(null)}\n                  </CardFooter>\n              </Card>\n            </Col>\n            <Col md=\"6\" lg=\"6\">\n                <Card className=\"card-tasks\">\n                  <CardHeader>\n                    <Row>\n                      <Col md=\"12\">\n                        <CardTitle tag=\"h4\">\n                          Mensajes Enviados\n                        </CardTitle>\n                      </Col>\n                      <Col md=\"6\">\n                        <Select\n                          className=\"react-select primary\"\n                          classNamePrefix=\"react-select\"\n                          name=\"singleSelect\"\n                          value={this.state.parabuscar}\n                          onChange={(value) =>\n                            this.verMensaje(this.props.colegio.codigo,value.key)\n                          }\n                          options={this.props.Grado}\n                          placeholder=\"Seleccion el Grado o año\"\n                        />\n                      </Col>\n                    </Row>\n                  </CardHeader>\n                  <CardBody>\n                    <div className=\"table-full-width table-responsive\">\n                      <Table>\n                        <tbody>\n                          {this.state.mensajes.map(mensaje=>(\n                              <tr>\n                                <td >\n                                  <div className=\"timeline-badge danger\">\n                                    <i className=\"nc-icon nc-single-copy-04\" />\n                                  </div>\n                                </td>\n                                <td className=\"text-left\">\n                                  {mensaje.grado.label} {mensaje.seccion}\n                                </td>\n                                <td className=\"text-left\">\n                                  {mensaje.mensaje}\n                                </td>\n                                <td className=\"text-left\">\n                                  {mensaje.fecha} ({mensaje.hora})\n                                </td>\n                              </tr>\n                            ))}\n                        </tbody>\n                      </Table>\n                    </div>\n                  </CardBody>\n                  <CardFooter>\n                    <hr />\n                    <div className=\"stats\">\n                      <i className=\"fa fa-refresh spin\" />\n                      Updated 3 minutes ago\n                    </div>\n                  </CardFooter>\n                </Card>\n              </Col>\n            {/* <Col md=\"6\" lg=\"6\">\n              <Card>\n                <CardHeader>\n                  <CardText tag=\"div\">\n                    <CardTitle tag=\"h4\">Mensajes Enviados</CardTitle>\n                  </CardText>\n                </CardHeader>\n                <CardBody className=\"table-responsive\">\n                  <Table className=\"table-hover\">\n                    <thead className=\"text-warning\">\n                      <tr>\n                        <th>#</th>\n                        <th>Grado</th>\n                        <th>Asunto</th>\n                        <th>Mensaje</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                    </tbody>\n                  </Table>\n                </CardBody>\n              </Card>\n            </Col> */}\n          </Row>\n        </div>\n      </>\n    );\n  }\n}\n\nconst mapStateToProps = (reducers) => {\n  return reducers.mainReducer;\n}\n\nexport default connect(mapStateToProps, mainActions )(Mensajes);\n"]},"metadata":{},"sourceType":"module"}